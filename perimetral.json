{"nftables": [{"metainfo": {"version": "0.9.3", "release_name": "Topsy", "json_schema_version": 1}}, {"table": {"family": "ip", "name": "firewall", "handle": 4}}, {"chain": {"family": "ip", "table": "firewall", "name": "inputfirewall", "handle": 1, "type": "filter", "hook": "input", "prio": 0, "policy": "drop"}}, {"rule": {"family": "ip", "table": "firewall", "chain": "inputfirewall", "handle": 4, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s3"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 22}}, {"counter": {"packets": 447, "bytes": 23412}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "inputfirewall", "handle": 7, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "inputfirewall", "handle": 8, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "inputfirewall", "handle": 10, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.111.0", "len": 24}}}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"chain": {"family": "ip", "table": "firewall", "name": "output", "handle": 2, "type": "filter", "hook": "output", "prio": 0, "policy": "drop"}}, {"rule": {"family": "ip", "table": "firewall", "chain": "outputfirewall", "handle": 5, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s3"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 22}}, {"counter": {"packets": 294, "bytes": 33012}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "outputfirewall", "handle": 6, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "outputfirewall", "handle": 9, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "outputfirewall", "handle": 11, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.111.0", "len": 24}}}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"chain": {"family": "ip", "table": "firewall", "name": "forward", "handle": 3, "type": "filter", "hook": "forward", "prio": 0, "policy": "drop"}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 12, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 3, "bytes": 252}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 13, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 3, "bytes": 252}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 14, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 15, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "icmp"}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 16, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "dport"}}, "right": 53}}, {"counter": {"packets": 1, "bytes": 72}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 17, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "sport"}}, "right": 53}}, {"counter": {"packets": 1, "bytes": 72}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 18, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.111.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "dport"}}, "right": 53}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 19, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.111.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "sport"}}, "right": 53}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 20, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 80}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 21, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 80}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 22, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 443}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 23, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s8"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": {"prefix": {"addr": "192.168.33.0", "len": 24}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 443}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 24, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 80}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 25, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 80}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 26, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 443}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 27, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 443}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 28, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 25}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 29, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 25}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 30, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "192.168.100.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 3306}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}, {"rule": {"family": "ip", "table": "firewall", "chain": "fordardfirewall", "handle": 31, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "enp0s9"}}, {"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "enp0s10"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "saddr"}}, "right": "192.168.100.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "192.168.200.2"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "sport"}}, "right": 3306}}, {"counter": {"packets": 0, "bytes": 0}}, {"accept": null}]}}]}
